<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Personal Identity Code Tool</title>
</head>
<body>

<h3>Check Personal Identity Code</h3>

<input id="picInput" placeholder="Enter PIC like 131052-308T">
<button onclick="checkPIC()">Validate</button>

<p id="result1"></p>

<hr>

<h3>Generate Check Character</h3>

<input id="dateInput" placeholder="DDMMYY">
<input id="uniqueInput" placeholder="002-899">
<button onclick="generateID()">Generate</button>

<p id="result2"></p>

<script>


// MAIN VALIDATION FUNCTION (your code, minimally fixed)

function checkPIC() {
    let pic = document.getElementById("picInput").value.trim();
    let out = document.getElementById("result1");

    if (pic.length < 11) {
        out.innerHTML = "Invalid: too short";
        return;
    }

    let day = pic.substring(0, 2);
    let month = pic.substring(2, 4);
    let year = pic.substring(4, 6);
    let century = pic.charAt(6);
    let pc = pic.substring(7, 10);
    let checkChar = pic.charAt(10);

    let fullyear = "";
    if (century == "+") fullyear = "18" + year;
    else if (century == "-") fullyear = "19" + year;
    else if (century == "A") fullyear = "20" + year;

    let day1 = Number(day);
    let month1 = Number(month);
    let fullyear1 = Number(fullyear);

    // Validate month/day
    let maxDay = 31;
    if (month1 < 1 || month1 > 12) {
        out.innerHTML = "is valid: false, month is wrong";
        return;
    }

    // Days per month
    if ([4,6,9,11].includes(month1)) maxDay = 30;
    else if (month1 === 2) {
        if ((fullyear1 % 400 === 0) || (fullyear1 % 4 === 0 && fullyear1 % 100 !== 0))
            maxDay = 29;
        else
            maxDay = 28;
    }

    if (day1 < 1 || day1 > maxDay) {
        out.innerHTML = "is valid: false, day is wrong";
        return;
    }

    // Determine sex
    let sex;
    let pcNum = Number(pc);
    if (pcNum % 2 === 0) sex = "Female";
    else sex = "Male";

    // Age calculation
    let today = new Date();
    let currentYear = today.getFullYear();
    let currentMonth = today.getMonth() + 1;
    let currentDay = today.getDate();

    let age = currentYear - fullyear1;

    if (currentMonth < month1 || (currentMonth === month1 && currentDay < day1)) {
        age -= 1;
    }

    // Calculate years, months, days
    let yearss = age;
    let monthss = currentMonth - month1;

    if (monthss < 0) monthss += 12;

    if (currentDay < day1) monthss -= 1;

    let previousMonth = currentMonth - 1;
    if (previousMonth === 0) previousMonth = 12;

    let daysInPreviousMonth;
    if ([1,3,5,7,8,10,12].includes(previousMonth)) daysInPreviousMonth = 31;
    else if ([4,6,9,11].includes(previousMonth)) daysInPreviousMonth = 30;
    else if (previousMonth === 2) {
        if ((currentYear % 400 == 0) || (currentYear % 4 == 0 && currentYear % 100 != 0))
            daysInPreviousMonth = 29;
        else
            daysInPreviousMonth = 28;
    }

    let dayss = currentDay - day1;
    if (dayss < 0) {
        dayss = (currentDay + daysInPreviousMonth) - day1;
        monthss -= 1;
    }

    // Build output text
    let text =
        "is valid: true<br>" +
        "sex: " + sex + "<br>" +
        "age: " + yearss + "<br>" + " (" + yearss + " years " + monthss + " months " + dayss + " days)";

    out.innerHTML = text;
}


// SECOND FUNCTION â€“ Generate Check Character

function generateID() {
    let date = document.getElementById("dateInput").value.trim();   // DDMMYY
    let unique = document.getElementById("uniqueInput").value.trim(); // 002-899
    let out = document.getElementById("result2");

    let uniqueId = date + unique;
    let uniqueId1 = Number(uniqueId);

    let remainder = uniqueId1 % 31;

    let idCheck = "0123456789ABCDEFHJKLMNPRSTUVWXY";
    let Output = idCheck.charAt(remainder);

    out.innerHTML = "Check character = " + Output;
}

</script>

</body>
</html>


























































































































































































































































































































































<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Identity Code</title>
</head>
<body>



<script>
let pic = prompt("Enter your personal identity code here: ")
console.log("Input: ", pic)
let day = pic.substring(0, 2);
let month = pic.substring(2, 4);
let year = pic.substring(4, 6);
let century = pic.charAt(6);
let pc = pic.substring(7, 10);
let fullyear = "";
if (century == "+") {
    fullyear = "18" + year
} else if (century == "-") {
    fullyear = "19" + year
} else if (century == "A") {
    fullyear = "20" + year
}
let day1 = Number(day)
let month1 = Number(month)
let fullyear1 = Number(fullyear)
if (month1 >= 1 && month1 <= 12) {
    if (day1 >= 1) {
        let maxDay;

        if (day1 <= maxDay) {
            console.log("is valid: true");

        } else{ 
            console.log("is valid: day is invalid");
            
        }

    } else {
        console.log("is valid: Day is invalid");
    }
} else {
    console.log("is valid: month is invalid")
}
let pc1 = Number(pc)
let sex;
if (pc % 2 == 0) {
    sex = "Female"
    console.log("sex:", sex)
} else {
    sex ="Male"
    console.log("sex:", sex)
}

let today = new Date();
let currentYear = today.getFullYear()
let currentMonth = today.getMonth() + 1
let currentDay = today.getDate()
let age = currentYear - fullyear1
if (currentMonth <= month1) {
    age = age - 1
} else if (currentMonth == month1 && currentDay <= day1) {
    age = age - 1
}
console.log("age = ", age)

let yearss = age;

let monthss = currentMonth - month1;
if (monthss < 0) {
    monthss += 12;
}

// adjust months if days will require borrowing
if (currentDay < day1) {
    monthss -= 1;
    if (monthss < 0) {
        monthss += 12;
    }
}

// get previous month
let previousMonth = currentMonth - 1;
if (previousMonth === 0) {
    previousMonth = 12;
}

let daysInPreviousMonth;

if (previousMonth == 1 || previousMonth == 3 || previousMonth == 5 || previousMonth == 7 ||
    previousMonth == 8 || previousMonth == 10 || previousMonth == 12) {

    daysInPreviousMonth = 31;

} else if (previousMonth == 4 || previousMonth == 6 || previousMonth == 9 || previousMonth == 11) {

    daysInPreviousMonth = 30;

} else if (previousMonth == 2) {

    if ((currentYear % 400 == 0) || (currentYear % 4 == 0 && currentYear % 100 != 0)) {
        daysInPreviousMonth = 29;
    } else {
        daysInPreviousMonth = 28;
    }
}

let dayss = currentDay - day1;

if (dayss < 0) {
    dayss = (currentDay + daysInPreviousMonth) - day1;
    monthss -= 1;
}

console.log(`${yearss} years ${monthss} months ${dayss} days`);

// now second function
function findLastChar() {
    
    date = prompt("Enter your date DD/MM/YY here: ")
    unique = prompt("Enter your unique code from 002-899 here: ")

    uniqueId = date+unique
    uniqueId1 = Number(uniqueId)
    remainder = uniqueId1 % 31
    let idCheck = "0123456789ABCDEFHJKLMNPRSTUVWXY"
    Output = idCheck.charAt(remainder)
    console.log(Output)

}
findLastChar();


</script>
</body>
</html> -->

